{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "At the bottom of this notebook there is an interactive MXNet example. It Lets you vary the inputs with sliders and will compute outputs and gradients. You can even edit the network to make it more complex!\n",
    "\n",
    "A video of this working is here: https://www.youtube.com/watch?v=-KmImwP5eGk\n",
    "Joseph Paul Cohen 2016 (Code free for non-commercial use)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 76,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "import mxnet as mx\n",
    "import cmath\n",
    "import numpy as np\n",
    "\n",
    "from __future__ import print_function\n",
    "from ipywidgets import interact, interactive, fixed\n",
    "import ipywidgets as widgets"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "def compute(s=None, x0=1, x1=1, x2=1, w0=1, w1=1, w2=1):\n",
    "\n",
    "    # Specify inputs we declared \n",
    "    args={'x0': mx.nd.array([x0]),\n",
    "          'x1': mx.nd.array([x1]),\n",
    "          'x2': mx.nd.array([x2]),\n",
    "          'w0': mx.nd.array([w0]),\n",
    "          'w1': mx.nd.array([w1]),\n",
    "          'w2': mx.nd.array([w2])\n",
    "         }\n",
    "\n",
    "\n",
    "    sym = s.get_internals()\n",
    "    blob_names = sym.list_outputs()\n",
    "    sym_group = []\n",
    "    for i in range(len(blob_names)):\n",
    "        if blob_names[i] not in args:\n",
    "            x = sym[i]\n",
    "            if blob_names[i] not in sym.list_outputs():\n",
    "                x = mx.symbol.BlockGrad(x, name=blob_names[i])\n",
    "            sym_group.append(x)\n",
    "    sym = mx.symbol.Group(sym_group)\n",
    "\n",
    "\n",
    "    # Bind to symbol and create executor\n",
    "    c_exec = sym.simple_bind(\n",
    "                    ctx=mx.cpu(),\n",
    "                    x0 = args['x0'].shape,\n",
    "                    x1 = args['x1'].shape,\n",
    "                    w0 = args['w0'].shape, \n",
    "                    w1 = args['w1'].shape, \n",
    "                    x2 = args['x2'].shape,\n",
    "                    w2 = args['w2'].shape)\n",
    "\n",
    "    # Copy input values into executor memory\n",
    "    c_exec.copy_params_from(arg_params = args)\n",
    "\n",
    "    # Perform computation forward to populate outputs\n",
    "    c_exec.forward()\n",
    "\n",
    "    values = []\n",
    "    values = values + [(k,v.asnumpy()[0]) for k,v in zip(sym.list_arguments(),c_exec.arg_arrays)]\n",
    "    values = values + [(k,v.asnumpy()[0]) for k,v in zip(sym.list_outputs(),c_exec.outputs)]\n",
    "\n",
    "    # Bind to symbol and create executor\n",
    "    c_exec = s.simple_bind(\n",
    "                    ctx=mx.cpu(),\n",
    "                    x0 = args['x0'].shape,\n",
    "                    x1 = args['x1'].shape,\n",
    "                    w0 = args['w0'].shape, \n",
    "                    w1 = args['w1'].shape, \n",
    "                    x2 = args['x2'].shape, \n",
    "                    w2 = args['w2'].shape)\n",
    "\n",
    "    # Copy input values into executor memory\n",
    "    c_exec.copy_params_from(arg_params = args)\n",
    "\n",
    "    # Perform computation forward to populate outputs\n",
    "    c_exec.forward()\n",
    "\n",
    "    # Backpropagate to calculate gradients \n",
    "    c_exec.backward(out_grads=mx.nd.array([1]))\n",
    "\n",
    "    grads = []\n",
    "    grads = grads + [(k,v.asnumpy()[0]) for k,v in zip(s.list_arguments(),c_exec.grad_arrays)]\n",
    "\n",
    "    # Use these for debugging\n",
    "    #for k,v in values: print(\"%20s=%.03f\"% (k,v))\n",
    "    #for k,v in grads: print(\"%20s=%.03f\"% (\"dout/d%s\"%k,v))\n",
    "    \n",
    "    values_dict = dict(values)\n",
    "    grads_dict = dict(grads)\n",
    "\n",
    "    # Print computation graph of s.get_internals() because is shows more nodes\n",
    "    a = plot_network2(sym, shape={\n",
    "                                  \"w0\":(1,), \n",
    "                                  \"x0\":(1,),\n",
    "                                  \"w1\":(1,),\n",
    "                                  \"x1\":(1,),\n",
    "                                  \"x2\":(1,),\n",
    "                                  \"w2\":(1,)},\n",
    "                            node_attrs={\"shape\":'rect',\"fixedsize\":'false'},\n",
    "                     values_dict=values_dict, grads_dict=grads_dict)\n",
    "    #Rotate the graphviz object that is returned\n",
    "    a.body.extend(['rankdir=RL', 'size=\"10,5\"'])\n",
    "\n",
    "    del c_exec\n",
    "    del sym\n",
    "    \n",
    "    #Show it. Use a.render() to write it to disk\n",
    "    return a"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 78,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "## Here we define a new print network function\n",
    "\n",
    "from __future__ import absolute_import\n",
    "from mxnet.symbol import Symbol\n",
    "import json\n",
    "import re\n",
    "import copy\n",
    "\n",
    "def plot_network2(symbol, title=\"plot\", shape=None, node_attrs={}, values_dict=None, grads_dict=None):\n",
    "    try:\n",
    "        from graphviz import Digraph\n",
    "    except:\n",
    "        raise ImportError(\"Draw network requires graphviz library\")\n",
    "    if not isinstance(symbol, Symbol):\n",
    "        raise TypeError(\"symbol must be Symbol\")\n",
    "    draw_shape = False\n",
    "    if shape != None:\n",
    "        draw_shape = True\n",
    "        interals = symbol.get_internals()\n",
    "        _, out_shapes, _ = interals.infer_shape(**shape)\n",
    "        if out_shapes == None:\n",
    "            raise ValueError(\"Input shape is incompete\")\n",
    "        shape_dict = dict(zip(interals.list_outputs(), out_shapes))\n",
    "    conf = json.loads(symbol.tojson())\n",
    "    nodes = conf[\"nodes\"]\n",
    "    #print(conf)\n",
    "    heads = set([x[0] for x in conf[\"heads\"]])  # TODO(xxx): check careful\n",
    "    #print(heads)\n",
    "    # default attributes of node\n",
    "    node_attr = {\"shape\": \"box\", \"fixedsize\": \"true\",\n",
    "                 \"width\": \"1.3\", \"height\": \"0.8034\", \"style\": \"filled\"}\n",
    "    # merge the dcit provided by user and the default one\n",
    "    node_attr.update(node_attrs)\n",
    "    dot = Digraph(name=title)\n",
    "    dot.body.extend(['rankdir=RL', 'size=\"10,5\"'])\n",
    "    # color map\n",
    "    cm = (\"#8dd3c7\", \"#fb8072\", \"#ffffb3\", \"#bebada\", \"#80b1d3\",\n",
    "          \"#fdb462\", \"#b3de69\", \"#fccde5\")\n",
    "\n",
    "    # make nodes\n",
    "    for i in range(len(nodes)):\n",
    "        node = nodes[i]\n",
    "        op = node[\"op\"]\n",
    "        name = node[\"name\"]\n",
    "        # input data\n",
    "        attr = copy.deepcopy(node_attr)\n",
    "        label = op\n",
    "\n",
    "        if op == \"null\":\n",
    "            label = node[\"name\"]\n",
    "            if grads_dict != None and label in grads_dict:\n",
    "                label = label + (\"\\n d%s: %.2f\" % (label, grads_dict[label]))\n",
    "            \n",
    "        attr[\"fillcolor\"] = cm[1]\n",
    "        \n",
    "        if op == \"Convolution\":\n",
    "            label = \"Convolution\\n%sx%s/%s, %s\" % (_str2tuple(node[\"param\"][\"kernel\"])[0],\n",
    "                                                   _str2tuple(node[\"param\"][\"kernel\"])[1],\n",
    "                                                   _str2tuple(node[\"param\"][\"stride\"])[0],\n",
    "                                                   node[\"param\"][\"num_filter\"])\n",
    "            attr[\"fillcolor\"] = cm[1]\n",
    "        elif op == \"FullyConnected\":\n",
    "            label = \"FullyConnected\\n%s\" % node[\"param\"][\"num_hidden\"]\n",
    "            attr[\"fillcolor\"] = cm[1]\n",
    "        elif op == \"BatchNorm\":\n",
    "            attr[\"fillcolor\"] = cm[3]\n",
    "        elif op == \"Activation\" or op == \"LeakyReLU\":\n",
    "            label = \"%s\\n%s\" % (op, node[\"param\"][\"act_type\"])\n",
    "            attr[\"fillcolor\"] = cm[2]\n",
    "        elif op == \"Pooling\":\n",
    "            label = \"Pooling\\n%s, %sx%s/%s\" % (node[\"param\"][\"pool_type\"],\n",
    "                                               _str2tuple(node[\"param\"][\"kernel\"])[0],\n",
    "                                               _str2tuple(node[\"param\"][\"kernel\"])[1],\n",
    "                                               _str2tuple(node[\"param\"][\"stride\"])[0])\n",
    "            attr[\"fillcolor\"] = cm[4]\n",
    "        elif op == \"Concat\" or op == \"Flatten\" or op == \"Reshape\":\n",
    "            attr[\"fillcolor\"] = cm[5]\n",
    "        elif op == \"Softmax\":\n",
    "            attr[\"fillcolor\"] = cm[6]\n",
    "        else:\n",
    "            attr[\"fillcolor\"] = cm[0]\n",
    "\n",
    "        dot.node(name=name, label=label, **attr)\n",
    "    \n",
    "    # add edges\n",
    "    for i in range(len(nodes)):\n",
    "        node = nodes[i]\n",
    "        op = node[\"op\"]\n",
    "        name = node[\"name\"]\n",
    "        inputs = node[\"inputs\"]\n",
    "        for item in inputs:\n",
    "            input_node = nodes[item[0]]\n",
    "            input_name = input_node[\"name\"]\n",
    "            attr = {\"dir\": \"back\", 'arrowtail':'open'}\n",
    "                \n",
    "            label = \"\"\n",
    "            if values_dict != None and input_name in values_dict:\n",
    "                label = \"%.2f\" % values_dict[input_name]               \n",
    "                \n",
    "            if values_dict != None and input_name + \"_output\" in values_dict:\n",
    "                label = \"%.2f\" % values_dict[input_name + \"_output\"]\n",
    "                \n",
    "            #if grads_dict != None and input_name in grads_dict:\n",
    "            #    label = label + (\"/%.2f\" %grads_dict[input_name])\n",
    "    \n",
    "            attr[\"label\"] = label.replace(\"_\",\"\")\n",
    "            dot.edge(tail_name=name, head_name=input_name, **attr)\n",
    "    return dot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 2.38.0 (20140413.2041)\n",
       " -->\n",
       "<!-- Title: plot Pages: 1 -->\n",
       "<svg width=\"720pt\" height=\"206pt\"\n",
       " viewBox=\"0.00 0.00 720.00 205.71\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(0.699708 0.699708) rotate(0) translate(4 290)\">\n",
       "<title>plot</title>\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-290 1025,-290 1025,4 -4,4\"/>\n",
       "<!-- w0 -->\n",
       "<g id=\"node1\" class=\"node\"><title>w0</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"94,-286 -7.10543e-15,-286 -7.10543e-15,-228 94,-228 94,-286\"/>\n",
       "<text text-anchor=\"middle\" x=\"47\" y=\"-259.8\" font-family=\"Times,serif\" font-size=\"14.00\">w0</text>\n",
       "<text text-anchor=\"middle\" x=\"47\" y=\"-245.8\" font-family=\"Times,serif\" font-size=\"14.00\"> dw0: 1.00</text>\n",
       "</g>\n",
       "<!-- x0 -->\n",
       "<g id=\"node2\" class=\"node\"><title>x0</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"94,-210 -7.10543e-15,-210 -7.10543e-15,-152 94,-152 94,-210\"/>\n",
       "<text text-anchor=\"middle\" x=\"47\" y=\"-183.8\" font-family=\"Times,serif\" font-size=\"14.00\">x0</text>\n",
       "<text text-anchor=\"middle\" x=\"47\" y=\"-169.8\" font-family=\"Times,serif\" font-size=\"14.00\"> dx0: 1.00</text>\n",
       "</g>\n",
       "<!-- _mul419 -->\n",
       "<g id=\"node3\" class=\"node\"><title>_mul419</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"248.5,-210 154.5,-210 154.5,-152 248.5,-152 248.5,-210\"/>\n",
       "<text text-anchor=\"middle\" x=\"201.5\" y=\"-176.8\" font-family=\"Times,serif\" font-size=\"14.00\">_Mul</text>\n",
       "</g>\n",
       "<!-- _mul419&#45;&gt;w0 -->\n",
       "<g id=\"edge1\" class=\"edge\"><title>_mul419&#45;&gt;w0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M145.176,-208.571C128.383,-216.94 110.123,-226.04 94.012,-234.069\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"154.331,-204.009 147.388,-212.497 149.856,-206.239 145.381,-208.469 145.381,-208.469 145.381,-208.469 149.856,-206.239 143.374,-204.442 154.331,-204.009 154.331,-204.009\"/>\n",
       "<text text-anchor=\"middle\" x=\"124.25\" y=\"-225.8\" font-family=\"Times,serif\" font-size=\"14.00\">1.00</text>\n",
       "</g>\n",
       "<!-- _mul419&#45;&gt;x0 -->\n",
       "<g id=\"edge2\" class=\"edge\"><title>_mul419&#45;&gt;x0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M144.241,-181C127.708,-181 109.825,-181 94.012,-181\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"154.331,-181 144.331,-185.5 149.331,-181 144.331,-181 144.331,-181 144.331,-181 149.331,-181 144.331,-176.5 154.331,-181 154.331,-181\"/>\n",
       "<text text-anchor=\"middle\" x=\"124.25\" y=\"-183.8\" font-family=\"Times,serif\" font-size=\"14.00\">1.00</text>\n",
       "</g>\n",
       "<!-- w1 -->\n",
       "<g id=\"node4\" class=\"node\"><title>w1</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"94,-134 -7.10543e-15,-134 -7.10543e-15,-76 94,-76 94,-134\"/>\n",
       "<text text-anchor=\"middle\" x=\"47\" y=\"-107.8\" font-family=\"Times,serif\" font-size=\"14.00\">w1</text>\n",
       "<text text-anchor=\"middle\" x=\"47\" y=\"-93.8\" font-family=\"Times,serif\" font-size=\"14.00\"> dw1: 1.00</text>\n",
       "</g>\n",
       "<!-- x1 -->\n",
       "<g id=\"node5\" class=\"node\"><title>x1</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"94,-58 -7.10543e-15,-58 -7.10543e-15,-0 94,-0 94,-58\"/>\n",
       "<text text-anchor=\"middle\" x=\"47\" y=\"-31.8\" font-family=\"Times,serif\" font-size=\"14.00\">x1</text>\n",
       "<text text-anchor=\"middle\" x=\"47\" y=\"-17.8\" font-family=\"Times,serif\" font-size=\"14.00\"> dx1: 1.00</text>\n",
       "</g>\n",
       "<!-- _mul420 -->\n",
       "<g id=\"node6\" class=\"node\"><title>_mul420</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"248.5,-134 154.5,-134 154.5,-76 248.5,-76 248.5,-134\"/>\n",
       "<text text-anchor=\"middle\" x=\"201.5\" y=\"-100.8\" font-family=\"Times,serif\" font-size=\"14.00\">_Mul</text>\n",
       "</g>\n",
       "<!-- _mul420&#45;&gt;w1 -->\n",
       "<g id=\"edge3\" class=\"edge\"><title>_mul420&#45;&gt;w1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M144.241,-105C127.708,-105 109.825,-105 94.012,-105\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"154.331,-105 144.331,-109.5 149.331,-105 144.331,-105 144.331,-105 144.331,-105 149.331,-105 144.331,-100.5 154.331,-105 154.331,-105\"/>\n",
       "<text text-anchor=\"middle\" x=\"124.25\" y=\"-107.8\" font-family=\"Times,serif\" font-size=\"14.00\">1.00</text>\n",
       "</g>\n",
       "<!-- _mul420&#45;&gt;x1 -->\n",
       "<g id=\"edge4\" class=\"edge\"><title>_mul420&#45;&gt;x1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M145.176,-77.4286C128.383,-69.0599 110.123,-59.9597 94.012,-51.9305\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"154.331,-81.9912 143.374,-81.5584 149.856,-79.761 145.381,-77.5308 145.381,-77.5308 145.381,-77.5308 149.856,-79.761 147.388,-73.5032 154.331,-81.9912 154.331,-81.9912\"/>\n",
       "<text text-anchor=\"middle\" x=\"124.25\" y=\"-74.8\" font-family=\"Times,serif\" font-size=\"14.00\">1.00</text>\n",
       "</g>\n",
       "<!-- _plus140 -->\n",
       "<g id=\"node7\" class=\"node\"><title>_plus140</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"403,-182 309,-182 309,-124 403,-124 403,-182\"/>\n",
       "<text text-anchor=\"middle\" x=\"356\" y=\"-148.8\" font-family=\"Times,serif\" font-size=\"14.00\">_Plus</text>\n",
       "</g>\n",
       "<!-- _plus140&#45;&gt;_mul419 -->\n",
       "<g id=\"edge5\" class=\"edge\"><title>_plus140&#45;&gt;_mul419</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M298.741,-163.329C282.208,-166.365 264.325,-169.649 248.512,-172.552\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"308.831,-161.477 299.808,-167.709 303.913,-162.38 298.996,-163.283 298.996,-163.283 298.996,-163.283 303.913,-162.38 298.183,-158.857 308.831,-161.477 308.831,-161.477\"/>\n",
       "<text text-anchor=\"middle\" x=\"278.75\" y=\"-170.8\" font-family=\"Times,serif\" font-size=\"14.00\">1.00</text>\n",
       "</g>\n",
       "<!-- _plus140&#45;&gt;_mul420 -->\n",
       "<g id=\"edge6\" class=\"edge\"><title>_plus140&#45;&gt;_mul420</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M299.209,-135.44C282.545,-130.195 264.474,-124.507 248.512,-119.482\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"308.831,-138.468 297.941,-139.758 304.062,-136.967 299.292,-135.466 299.292,-135.466 299.292,-135.466 304.062,-136.967 300.644,-131.173 308.831,-138.468 308.831,-138.468\"/>\n",
       "<text text-anchor=\"middle\" x=\"278.75\" y=\"-134.8\" font-family=\"Times,serif\" font-size=\"14.00\">1.00</text>\n",
       "</g>\n",
       "<!-- x2 -->\n",
       "<g id=\"node8\" class=\"node\"><title>x2</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"403,-106 309,-106 309,-48 403,-48 403,-106\"/>\n",
       "<text text-anchor=\"middle\" x=\"356\" y=\"-79.8\" font-family=\"Times,serif\" font-size=\"14.00\">x2</text>\n",
       "<text text-anchor=\"middle\" x=\"356\" y=\"-65.8\" font-family=\"Times,serif\" font-size=\"14.00\"> dx2: 2.00</text>\n",
       "</g>\n",
       "<!-- _mul421 -->\n",
       "<g id=\"node9\" class=\"node\"><title>_mul421</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"557.5,-144 463.5,-144 463.5,-86 557.5,-86 557.5,-144\"/>\n",
       "<text text-anchor=\"middle\" x=\"510.5\" y=\"-110.8\" font-family=\"Times,serif\" font-size=\"14.00\">_Mul</text>\n",
       "</g>\n",
       "<!-- _mul421&#45;&gt;_plus140 -->\n",
       "<g id=\"edge7\" class=\"edge\"><title>_mul421&#45;&gt;_plus140</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M453.241,-129.019C436.708,-133.138 418.825,-137.595 403.012,-141.535\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"463.331,-126.504 454.716,-133.289 458.479,-127.713 453.628,-128.922 453.628,-128.922 453.628,-128.922 458.479,-127.713 452.54,-124.556 463.331,-126.504 463.331,-126.504\"/>\n",
       "<text text-anchor=\"middle\" x=\"433.25\" y=\"-138.8\" font-family=\"Times,serif\" font-size=\"14.00\">2.00</text>\n",
       "</g>\n",
       "<!-- _mul421&#45;&gt;x2 -->\n",
       "<g id=\"edge8\" class=\"edge\"><title>_mul421&#45;&gt;x2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M453.241,-100.981C436.708,-96.8616 418.825,-92.4055 403.012,-88.4653\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"463.331,-103.496 452.54,-105.444 458.479,-102.287 453.628,-101.078 453.628,-101.078 453.628,-101.078 458.479,-102.287 454.716,-96.7112 463.331,-103.496 463.331,-103.496\"/>\n",
       "<text text-anchor=\"middle\" x=\"433.25\" y=\"-101.8\" font-family=\"Times,serif\" font-size=\"14.00\">1.00</text>\n",
       "</g>\n",
       "<!-- w2 -->\n",
       "<g id=\"node10\" class=\"node\"><title>w2</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"557.5,-68 463.5,-68 463.5,-10 557.5,-10 557.5,-68\"/>\n",
       "<text text-anchor=\"middle\" x=\"510.5\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">w2</text>\n",
       "<text text-anchor=\"middle\" x=\"510.5\" y=\"-27.8\" font-family=\"Times,serif\" font-size=\"14.00\"> dw2: 1.00</text>\n",
       "</g>\n",
       "<!-- _plus141 -->\n",
       "<g id=\"node11\" class=\"node\"><title>_plus141</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"712,-86 618,-86 618,-28 712,-28 712,-86\"/>\n",
       "<text text-anchor=\"middle\" x=\"665\" y=\"-52.8\" font-family=\"Times,serif\" font-size=\"14.00\">_Plus</text>\n",
       "</g>\n",
       "<!-- _plus141&#45;&gt;_mul421 -->\n",
       "<g id=\"edge9\" class=\"edge\"><title>_plus141&#45;&gt;_mul421</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M608.209,-78.2189C591.545,-84.5565 573.474,-91.4296 557.512,-97.5004\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"617.831,-74.5593 610.084,-82.3203 613.158,-76.3368 608.484,-78.1142 608.484,-78.1142 608.484,-78.1142 613.158,-76.3368 606.885,-73.9082 617.831,-74.5593 617.831,-74.5593\"/>\n",
       "<text text-anchor=\"middle\" x=\"587.75\" y=\"-92.8\" font-family=\"Times,serif\" font-size=\"14.00\">2.00</text>\n",
       "</g>\n",
       "<!-- _plus141&#45;&gt;w2 -->\n",
       "<g id=\"edge10\" class=\"edge\"><title>_plus141&#45;&gt;w2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M607.741,-50.3596C591.208,-48.4081 573.325,-46.2973 557.512,-44.4309\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"617.831,-51.5506 607.373,-54.8473 612.866,-50.9644 607.9,-50.3783 607.9,-50.3783 607.9,-50.3783 612.866,-50.9644 608.428,-45.9093 617.831,-51.5506 617.831,-51.5506\"/>\n",
       "<text text-anchor=\"middle\" x=\"587.75\" y=\"-52.8\" font-family=\"Times,serif\" font-size=\"14.00\">1.00</text>\n",
       "</g>\n",
       "<!-- relu1 -->\n",
       "<g id=\"node12\" class=\"node\"><title>relu1</title>\n",
       "<polygon fill=\"#ffffb3\" stroke=\"black\" points=\"866.5,-86 772.5,-86 772.5,-28 866.5,-28 866.5,-86\"/>\n",
       "<text text-anchor=\"middle\" x=\"819.5\" y=\"-59.8\" font-family=\"Times,serif\" font-size=\"14.00\">Activation</text>\n",
       "<text text-anchor=\"middle\" x=\"819.5\" y=\"-45.8\" font-family=\"Times,serif\" font-size=\"14.00\">relu</text>\n",
       "</g>\n",
       "<!-- relu1&#45;&gt;_plus141 -->\n",
       "<g id=\"edge11\" class=\"edge\"><title>relu1&#45;&gt;_plus141</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M762.241,-57C745.708,-57 727.825,-57 712.012,-57\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"772.331,-57 762.331,-61.5001 767.331,-57 762.331,-57.0001 762.331,-57.0001 762.331,-57.0001 767.331,-57 762.331,-52.5001 772.331,-57 772.331,-57\"/>\n",
       "<text text-anchor=\"middle\" x=\"742.25\" y=\"-59.8\" font-family=\"Times,serif\" font-size=\"14.00\">3.00</text>\n",
       "</g>\n",
       "<!-- _plusscalar131 -->\n",
       "<g id=\"node13\" class=\"node\"><title>_plusscalar131</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"1021,-86 927,-86 927,-28 1021,-28 1021,-86\"/>\n",
       "<text text-anchor=\"middle\" x=\"974\" y=\"-52.8\" font-family=\"Times,serif\" font-size=\"14.00\">_PlusScalar</text>\n",
       "</g>\n",
       "<!-- _plusscalar131&#45;&gt;relu1 -->\n",
       "<g id=\"edge12\" class=\"edge\"><title>_plusscalar131&#45;&gt;relu1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M916.741,-57C900.208,-57 882.325,-57 866.512,-57\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"926.831,-57 916.831,-61.5001 921.831,-57 916.831,-57.0001 916.831,-57.0001 916.831,-57.0001 921.831,-57 916.831,-52.5001 926.831,-57 926.831,-57\"/>\n",
       "<text text-anchor=\"middle\" x=\"896.75\" y=\"-59.8\" font-family=\"Times,serif\" font-size=\"14.00\">3.00</text>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.dot.Digraph at 0x111ca9f90>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "<function __main__.compute>"
      ]
     },
     "execution_count": 79,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "## Outputs from a node are shown on the edges and the gradients are shown in the box\n",
    "## Modify the s object in compute different functions\n",
    "\n",
    "# Declare input values in mxnet type\n",
    "w0 = mx.symbol.Variable('w0')\n",
    "x0 = mx.symbol.Variable('x0')\n",
    "w1 = mx.symbol.Variable('w1')\n",
    "x1 = mx.symbol.Variable('x1')\n",
    "w2 = mx.symbol.Variable('w2')\n",
    "x2 = mx.symbol.Variable('x2')\n",
    "\n",
    "# Form expression using overloaded +,-,*, and / operators\n",
    "# Use special mx methods to achieve other operations\n",
    "n = ((w0*x0 + w1*x1) * x2 + w2)\n",
    "s = mx.symbol.Activation(data=n, name='relu1', act_type=\"relu\")+0\n",
    "\n",
    "interact(compute, s=fixed(s), x0=1.0, w0=1.0, x1=1.0, w1=1.0, x2=1.0, w2=1.0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 80,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 2.38.0 (20140413.2041)\n",
       " -->\n",
       "<!-- Title: plot Pages: 1 -->\n",
       "<svg width=\"720pt\" height=\"160pt\"\n",
       " viewBox=\"0.00 0.00 720.00 160.36\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(0.538117 0.538117) rotate(0) translate(4 294)\">\n",
       "<title>plot</title>\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-294 1334,-294 1334,4 -4,4\"/>\n",
       "<!-- w0 -->\n",
       "<g id=\"node1\" class=\"node\"><title>w0</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"248.5,-58 154.5,-58 154.5,-0 248.5,-0 248.5,-58\"/>\n",
       "<text text-anchor=\"middle\" x=\"201.5\" y=\"-31.8\" font-family=\"Times,serif\" font-size=\"14.00\">w0</text>\n",
       "<text text-anchor=\"middle\" x=\"201.5\" y=\"-17.8\" font-family=\"Times,serif\" font-size=\"14.00\"> dw0: 1.00</text>\n",
       "</g>\n",
       "<!-- x0 -->\n",
       "<g id=\"node2\" class=\"node\"><title>x0</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"248.5,-136 154.5,-136 154.5,-78 248.5,-78 248.5,-136\"/>\n",
       "<text text-anchor=\"middle\" x=\"201.5\" y=\"-109.8\" font-family=\"Times,serif\" font-size=\"14.00\">x0</text>\n",
       "<text text-anchor=\"middle\" x=\"201.5\" y=\"-95.8\" font-family=\"Times,serif\" font-size=\"14.00\"> dx0: 2.00</text>\n",
       "</g>\n",
       "<!-- _mul422 -->\n",
       "<g id=\"node3\" class=\"node\"><title>_mul422</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"403,-58 309,-58 309,-0 403,-0 403,-58\"/>\n",
       "<text text-anchor=\"middle\" x=\"356\" y=\"-24.8\" font-family=\"Times,serif\" font-size=\"14.00\">_Mul</text>\n",
       "</g>\n",
       "<!-- _mul422&#45;&gt;w0 -->\n",
       "<g id=\"edge1\" class=\"edge\"><title>_mul422&#45;&gt;w0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M298.741,-29C282.208,-29 264.325,-29 248.512,-29\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"308.831,-29 298.831,-33.5001 303.831,-29 298.831,-29.0001 298.831,-29.0001 298.831,-29.0001 303.831,-29 298.831,-24.5001 308.831,-29 308.831,-29\"/>\n",
       "<text text-anchor=\"middle\" x=\"278.75\" y=\"-31.8\" font-family=\"Times,serif\" font-size=\"14.00\">1.00</text>\n",
       "</g>\n",
       "<!-- _mul422&#45;&gt;x0 -->\n",
       "<g id=\"edge2\" class=\"edge\"><title>_mul422&#45;&gt;x0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M299.676,-57.2969C282.883,-65.8859 264.623,-75.2256 248.512,-83.466\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"308.831,-52.6142 301.977,-61.1743 304.38,-54.8911 299.928,-57.168 299.928,-57.168 299.928,-57.168 304.38,-54.8911 297.879,-53.1616 308.831,-52.6142 308.831,-52.6142\"/>\n",
       "<text text-anchor=\"middle\" x=\"278.75\" y=\"-74.8\" font-family=\"Times,serif\" font-size=\"14.00\">1.00</text>\n",
       "</g>\n",
       "<!-- x2 -->\n",
       "<g id=\"node4\" class=\"node\"><title>x2</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"248.5,-290 154.5,-290 154.5,-232 248.5,-232 248.5,-290\"/>\n",
       "<text text-anchor=\"middle\" x=\"201.5\" y=\"-263.8\" font-family=\"Times,serif\" font-size=\"14.00\">x2</text>\n",
       "<text text-anchor=\"middle\" x=\"201.5\" y=\"-249.8\" font-family=\"Times,serif\" font-size=\"14.00\"> dx2: 4.00</text>\n",
       "</g>\n",
       "<!-- _mul423 -->\n",
       "<g id=\"node5\" class=\"node\"><title>_mul423</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"557.5,-123 463.5,-123 463.5,-65 557.5,-65 557.5,-123\"/>\n",
       "<text text-anchor=\"middle\" x=\"510.5\" y=\"-89.8\" font-family=\"Times,serif\" font-size=\"14.00\">_Mul</text>\n",
       "</g>\n",
       "<!-- _mul423&#45;&gt;_mul422 -->\n",
       "<g id=\"edge3\" class=\"edge\"><title>_mul423&#45;&gt;_mul422</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M454.086,-69.6896C451.184,-68.4374 448.309,-67.2014 445.5,-66 431.873,-60.1709 417.024,-53.9229 403.451,-48.2517\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"463.395,-73.7215 452.43,-73.8764 458.807,-71.7343 454.219,-69.7471 454.219,-69.7471 454.219,-69.7471 458.807,-71.7343 456.007,-65.6177 463.395,-73.7215 463.395,-73.7215\"/>\n",
       "<text text-anchor=\"middle\" x=\"433.25\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">1.00</text>\n",
       "</g>\n",
       "<!-- _mul423&#45;&gt;x2 -->\n",
       "<g id=\"edge4\" class=\"edge\"><title>_mul423&#45;&gt;x2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M453.118,-85.8692C410.31,-82.6419 351.724,-84.8223 309,-112 277.323,-132.15 283.996,-151.784 266.5,-185 257.791,-201.534 259.978,-208.252 248.5,-223 246.21,-225.943 243.654,-228.809 240.952,-231.563\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"463.093,-86.7395 452.74,-90.3532 458.112,-86.3049 453.131,-85.8702 453.131,-85.8702 453.131,-85.8702 458.112,-86.3049 453.522,-81.3873 463.093,-86.7395 463.093,-86.7395\"/>\n",
       "<text text-anchor=\"middle\" x=\"356\" y=\"-114.8\" font-family=\"Times,serif\" font-size=\"14.00\">1.00</text>\n",
       "</g>\n",
       "<!-- w1 -->\n",
       "<g id=\"node6\" class=\"node\"><title>w1</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"94,-252 -7.10543e-15,-252 -7.10543e-15,-194 94,-194 94,-252\"/>\n",
       "<text text-anchor=\"middle\" x=\"47\" y=\"-225.8\" font-family=\"Times,serif\" font-size=\"14.00\">w1</text>\n",
       "<text text-anchor=\"middle\" x=\"47\" y=\"-211.8\" font-family=\"Times,serif\" font-size=\"14.00\"> dw1: 1.00</text>\n",
       "</g>\n",
       "<!-- x1 -->\n",
       "<g id=\"node7\" class=\"node\"><title>x1</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"94,-176 -7.10543e-15,-176 -7.10543e-15,-118 94,-118 94,-176\"/>\n",
       "<text text-anchor=\"middle\" x=\"47\" y=\"-149.8\" font-family=\"Times,serif\" font-size=\"14.00\">x1</text>\n",
       "<text text-anchor=\"middle\" x=\"47\" y=\"-135.8\" font-family=\"Times,serif\" font-size=\"14.00\"> dx1: 1.00</text>\n",
       "</g>\n",
       "<!-- _mul424 -->\n",
       "<g id=\"node8\" class=\"node\"><title>_mul424</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"248.5,-214 154.5,-214 154.5,-156 248.5,-156 248.5,-214\"/>\n",
       "<text text-anchor=\"middle\" x=\"201.5\" y=\"-180.8\" font-family=\"Times,serif\" font-size=\"14.00\">_Mul</text>\n",
       "</g>\n",
       "<!-- _mul424&#45;&gt;w1 -->\n",
       "<g id=\"edge5\" class=\"edge\"><title>_mul424&#45;&gt;w1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M144.241,-199.019C127.708,-203.138 109.825,-207.595 94.012,-211.535\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"154.331,-196.504 145.716,-203.289 149.479,-197.713 144.628,-198.922 144.628,-198.922 144.628,-198.922 149.479,-197.713 143.54,-194.556 154.331,-196.504 154.331,-196.504\"/>\n",
       "<text text-anchor=\"middle\" x=\"124.25\" y=\"-208.8\" font-family=\"Times,serif\" font-size=\"14.00\">1.00</text>\n",
       "</g>\n",
       "<!-- _mul424&#45;&gt;x1 -->\n",
       "<g id=\"edge6\" class=\"edge\"><title>_mul424&#45;&gt;x1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M144.241,-170.981C127.708,-166.862 109.825,-162.405 94.012,-158.465\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"154.331,-173.496 143.54,-175.444 149.479,-172.287 144.628,-171.078 144.628,-171.078 144.628,-171.078 149.479,-172.287 145.716,-166.711 154.331,-173.496 154.331,-173.496\"/>\n",
       "<text text-anchor=\"middle\" x=\"124.25\" y=\"-170.8\" font-family=\"Times,serif\" font-size=\"14.00\">1.00</text>\n",
       "</g>\n",
       "<!-- _mul425 -->\n",
       "<g id=\"node9\" class=\"node\"><title>_mul425</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"403,-234 309,-234 309,-176 403,-176 403,-234\"/>\n",
       "<text text-anchor=\"middle\" x=\"356\" y=\"-200.8\" font-family=\"Times,serif\" font-size=\"14.00\">_Mul</text>\n",
       "</g>\n",
       "<!-- _mul425&#45;&gt;x2 -->\n",
       "<g id=\"edge8\" class=\"edge\"><title>_mul425&#45;&gt;x2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M299.004,-222.574C288.164,-226.194 276.935,-230.097 266.5,-234 260.739,-236.155 254.734,-238.523 248.81,-240.933\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"308.816,-219.337 300.729,-226.743 304.068,-220.903 299.32,-222.47 299.32,-222.47 299.32,-222.47 304.068,-220.903 297.91,-218.196 308.816,-219.337 308.816,-219.337\"/>\n",
       "<text text-anchor=\"middle\" x=\"278.75\" y=\"-236.8\" font-family=\"Times,serif\" font-size=\"14.00\">1.00</text>\n",
       "</g>\n",
       "<!-- _mul425&#45;&gt;_mul424 -->\n",
       "<g id=\"edge7\" class=\"edge\"><title>_mul425&#45;&gt;_mul424</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M299.07,-193.23C296.346,-192.785 293.646,-192.372 291,-192 277.264,-190.069 262.248,-188.631 248.549,-187.577\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"308.971,-194.955 298.347,-197.672 304.046,-194.097 299.12,-193.239 299.12,-193.239 299.12,-193.239 304.046,-194.097 299.892,-188.805 308.971,-194.955 308.971,-194.955\"/>\n",
       "<text text-anchor=\"middle\" x=\"278.75\" y=\"-194.8\" font-family=\"Times,serif\" font-size=\"14.00\">1.00</text>\n",
       "</g>\n",
       "<!-- _mul426 -->\n",
       "<g id=\"node10\" class=\"node\"><title>_mul426</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"557.5,-213 463.5,-213 463.5,-155 557.5,-155 557.5,-213\"/>\n",
       "<text text-anchor=\"middle\" x=\"510.5\" y=\"-179.8\" font-family=\"Times,serif\" font-size=\"14.00\">_Mul</text>\n",
       "</g>\n",
       "<!-- _mul426&#45;&gt;x0 -->\n",
       "<g id=\"edge10\" class=\"edge\"><title>_mul426&#45;&gt;x0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M453.399,-167.012C437.189,-162.282 419.437,-157.274 403,-153 350.463,-139.339 289.629,-125.684 248.873,-116.843\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"463.267,-169.912 452.404,-171.41 458.47,-168.502 453.673,-167.092 453.673,-167.092 453.673,-167.092 458.47,-168.502 454.941,-162.775 463.267,-169.912 463.267,-169.912\"/>\n",
       "<text text-anchor=\"middle\" x=\"356\" y=\"-155.8\" font-family=\"Times,serif\" font-size=\"14.00\">1.00</text>\n",
       "</g>\n",
       "<!-- _mul426&#45;&gt;_mul425 -->\n",
       "<g id=\"edge9\" class=\"edge\"><title>_mul426&#45;&gt;_mul425</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M453.241,-191.747C436.708,-194.024 418.825,-196.486 403.012,-198.664\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"463.331,-190.358 454.039,-196.18 458.378,-191.04 453.425,-191.722 453.425,-191.722 453.425,-191.722 458.378,-191.04 452.811,-187.264 463.331,-190.358 463.331,-190.358\"/>\n",
       "<text text-anchor=\"middle\" x=\"433.25\" y=\"-197.8\" font-family=\"Times,serif\" font-size=\"14.00\">1.00</text>\n",
       "</g>\n",
       "<!-- _plus142 -->\n",
       "<g id=\"node11\" class=\"node\"><title>_plus142</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"712,-213 618,-213 618,-155 712,-155 712,-213\"/>\n",
       "<text text-anchor=\"middle\" x=\"665\" y=\"-179.8\" font-family=\"Times,serif\" font-size=\"14.00\">_Plus</text>\n",
       "</g>\n",
       "<!-- _plus142&#45;&gt;_mul423 -->\n",
       "<g id=\"edge11\" class=\"edge\"><title>_plus142&#45;&gt;_mul423</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M609.142,-151.625C592.222,-141.639 573.772,-130.751 557.512,-121.155\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"617.831,-156.753 606.932,-155.546 613.525,-154.212 609.219,-151.67 609.219,-151.67 609.219,-151.67 613.525,-154.212 611.506,-147.795 617.831,-156.753 617.831,-156.753\"/>\n",
       "<text text-anchor=\"middle\" x=\"587.75\" y=\"-146.8\" font-family=\"Times,serif\" font-size=\"14.00\">1.00</text>\n",
       "</g>\n",
       "<!-- _plus142&#45;&gt;_mul426 -->\n",
       "<g id=\"edge12\" class=\"edge\"><title>_plus142&#45;&gt;_mul426</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M607.741,-184C591.208,-184 573.325,-184 557.512,-184\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"617.831,-184 607.831,-188.5 612.831,-184 607.831,-184 607.831,-184 607.831,-184 612.831,-184 607.831,-179.5 617.831,-184 617.831,-184\"/>\n",
       "<text text-anchor=\"middle\" x=\"587.75\" y=\"-186.8\" font-family=\"Times,serif\" font-size=\"14.00\">1.00</text>\n",
       "</g>\n",
       "<!-- _mul427 -->\n",
       "<g id=\"node12\" class=\"node\"><title>_mul427</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"866.5,-265 772.5,-265 772.5,-207 866.5,-207 866.5,-265\"/>\n",
       "<text text-anchor=\"middle\" x=\"819.5\" y=\"-231.8\" font-family=\"Times,serif\" font-size=\"14.00\">_Mul</text>\n",
       "</g>\n",
       "<!-- _mul427&#45;&gt;x2 -->\n",
       "<g id=\"edge14\" class=\"edge\"><title>_mul427&#45;&gt;x2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M762.624,-250.169C733.938,-256.257 698.314,-262 666,-262 666,-262 666,-262 355,-262 319.257,-262 278.803,-261.722 248.546,-261.459\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"772.464,-248.011 763.661,-254.549 767.58,-249.082 762.696,-250.154 762.696,-250.154 762.696,-250.154 767.58,-249.082 761.732,-245.758 772.464,-248.011 772.464,-248.011\"/>\n",
       "<text text-anchor=\"middle\" x=\"510.5\" y=\"-264.8\" font-family=\"Times,serif\" font-size=\"14.00\">1.00</text>\n",
       "</g>\n",
       "<!-- _mul427&#45;&gt;_plus142 -->\n",
       "<g id=\"edge13\" class=\"edge\"><title>_mul427&#45;&gt;_plus142</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M762.709,-216.976C746.045,-211.294 727.974,-205.132 712.012,-199.689\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"772.331,-220.257 761.414,-221.289 767.599,-218.643 762.866,-217.03 762.866,-217.03 762.866,-217.03 767.599,-218.643 764.319,-212.771 772.331,-220.257 772.331,-220.257\"/>\n",
       "<text text-anchor=\"middle\" x=\"742.25\" y=\"-215.8\" font-family=\"Times,serif\" font-size=\"14.00\">2.00</text>\n",
       "</g>\n",
       "<!-- w2 -->\n",
       "<g id=\"node13\" class=\"node\"><title>w2</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"866.5,-189 772.5,-189 772.5,-131 866.5,-131 866.5,-189\"/>\n",
       "<text text-anchor=\"middle\" x=\"819.5\" y=\"-162.8\" font-family=\"Times,serif\" font-size=\"14.00\">w2</text>\n",
       "<text text-anchor=\"middle\" x=\"819.5\" y=\"-148.8\" font-family=\"Times,serif\" font-size=\"14.00\"> dw2: 2.00</text>\n",
       "</g>\n",
       "<!-- _mul428 -->\n",
       "<g id=\"node14\" class=\"node\"><title>_mul428</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"1021,-217 927,-217 927,-159 1021,-159 1021,-217\"/>\n",
       "<text text-anchor=\"middle\" x=\"974\" y=\"-183.8\" font-family=\"Times,serif\" font-size=\"14.00\">_Mul</text>\n",
       "</g>\n",
       "<!-- _mul428&#45;&gt;_mul427 -->\n",
       "<g id=\"edge15\" class=\"edge\"><title>_mul428&#45;&gt;_mul427</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M917.209,-205.56C900.545,-210.805 882.474,-216.493 866.512,-221.518\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"926.831,-202.532 918.644,-209.827 922.062,-204.033 917.292,-205.534 917.292,-205.534 917.292,-205.534 922.062,-204.033 915.941,-201.242 926.831,-202.532 926.831,-202.532\"/>\n",
       "<text text-anchor=\"middle\" x=\"896.75\" y=\"-216.8\" font-family=\"Times,serif\" font-size=\"14.00\">2.00</text>\n",
       "</g>\n",
       "<!-- _mul428&#45;&gt;w2 -->\n",
       "<g id=\"edge16\" class=\"edge\"><title>_mul428&#45;&gt;w2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M916.741,-177.671C900.208,-174.635 882.325,-171.351 866.512,-168.448\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"926.831,-179.523 916.183,-182.143 921.913,-178.62 916.996,-177.717 916.996,-177.717 916.996,-177.717 921.913,-178.62 917.808,-173.291 926.831,-179.523 926.831,-179.523\"/>\n",
       "<text text-anchor=\"middle\" x=\"896.75\" y=\"-177.8\" font-family=\"Times,serif\" font-size=\"14.00\">1.00</text>\n",
       "</g>\n",
       "<!-- relu1 -->\n",
       "<g id=\"node15\" class=\"node\"><title>relu1</title>\n",
       "<polygon fill=\"#ffffb3\" stroke=\"black\" points=\"1175.5,-217 1081.5,-217 1081.5,-159 1175.5,-159 1175.5,-217\"/>\n",
       "<text text-anchor=\"middle\" x=\"1128.5\" y=\"-190.8\" font-family=\"Times,serif\" font-size=\"14.00\">Activation</text>\n",
       "<text text-anchor=\"middle\" x=\"1128.5\" y=\"-176.8\" font-family=\"Times,serif\" font-size=\"14.00\">relu</text>\n",
       "</g>\n",
       "<!-- relu1&#45;&gt;_mul428 -->\n",
       "<g id=\"edge17\" class=\"edge\"><title>relu1&#45;&gt;_mul428</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1071.24,-188C1054.71,-188 1036.82,-188 1021.01,-188\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1081.33,-188 1071.33,-192.5 1076.33,-188 1071.33,-188 1071.33,-188 1071.33,-188 1076.33,-188 1071.33,-183.5 1081.33,-188 1081.33,-188\"/>\n",
       "<text text-anchor=\"middle\" x=\"1051.25\" y=\"-190.8\" font-family=\"Times,serif\" font-size=\"14.00\">2.00</text>\n",
       "</g>\n",
       "<!-- _plusscalar132 -->\n",
       "<g id=\"node16\" class=\"node\"><title>_plusscalar132</title>\n",
       "<polygon fill=\"#8dd3c7\" stroke=\"black\" points=\"1330,-217 1236,-217 1236,-159 1330,-159 1330,-217\"/>\n",
       "<text text-anchor=\"middle\" x=\"1283\" y=\"-183.8\" font-family=\"Times,serif\" font-size=\"14.00\">_PlusScalar</text>\n",
       "</g>\n",
       "<!-- _plusscalar132&#45;&gt;relu1 -->\n",
       "<g id=\"edge18\" class=\"edge\"><title>_plusscalar132&#45;&gt;relu1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M1225.74,-188C1209.21,-188 1191.32,-188 1175.51,-188\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"1235.83,-188 1225.83,-192.5 1230.83,-188 1225.83,-188 1225.83,-188 1225.83,-188 1230.83,-188 1225.83,-183.5 1235.83,-188 1235.83,-188\"/>\n",
       "<text text-anchor=\"middle\" x=\"1205.75\" y=\"-190.8\" font-family=\"Times,serif\" font-size=\"14.00\">2.00</text>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.dot.Digraph at 0x111d66910>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "<function __main__.compute>"
      ]
     },
     "execution_count": 80,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "## Outputs from a node are shown on the edges and the gradients are shown in the box\n",
    "## Modify the s object in compute different functions\n",
    "\n",
    "# Declare input values in mxnet type\n",
    "w0 = mx.symbol.Variable('w0')\n",
    "x0 = mx.symbol.Variable('x0')\n",
    "w1 = mx.symbol.Variable('w1')\n",
    "x1 = mx.symbol.Variable('x1')\n",
    "w2 = mx.symbol.Variable('w2')\n",
    "x2 = mx.symbol.Variable('x2')\n",
    "\n",
    "# Form expression using overloaded +,-,*, and / operators\n",
    "# Use special mx methods to achieve other operations\n",
    "n = ((w0*x0*x2 + w1*x1*x2*x0) * x2*w2)\n",
    "s = mx.symbol.Activation(data=n, name='relu1', act_type=\"relu\")+0\n",
    "\n",
    "interact(compute, s=fixed(s), x0=1.0, w0=1.0, x1=1.0, w1=1.0, x2=1.0, w2=1.0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 2",
   "language": "python",
   "name": "python2"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 2
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython2",
   "version": "2.7.10"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 0
}
